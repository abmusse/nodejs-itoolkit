# Node.js Toolkit for IBM i <!-- omit in toc -->

- [Introduction](#introduction)
  - [Global Object itoolkit](#global-object-itoolkit)
    - [xmlToJson](#xmltojson)
    - [iCmd](#icmd)
    - [iSh](#ish)
  - [Class iConn](#class-iconn)
    - [iConn](#iconn)
    - [debug](#debug)
    - [add](#add)
    - [run](#run)
    - [getConnection](#getconnection)
    - [setTimeout](#settimeout)
  - [Class iPgm](#class-ipgm)
    - [iPgm](#ipgm)
    - [addParam](#addparam)
    - [addReturn](#addreturn)
    - [toXML](#toxml)
    - [Class iSql](#class-isql)
  - [iSql](#isql)
    - [addQuery](#addquery)
    - [fetch](#fetch)
    - [commit](#commit)
    - [prepare](#prepare)
    - [execute](#execute)
  - [Class iWork](#class-iwork)
    - [iWork](#iwork)
    - [getSysValue](#getsysvalue)
    - [getSysStatus](#getsysstatus)
    - [getSysStatusExt](#getsysstatusext)
    - [getJobStatus](#getjobstatus)
    - [getJobInfo](#getjobinfo)
    - [getDataArea](#getdataarea)
  - [Class iProd](#class-iprod)
    - [iProd](#iprod)
    - [getPTFInfo](#getptfinfo)
    - [getProductInfo](#getproductinfo)
    - [getInstalledProducts](#getinstalledproducts)
  - [Class iUserSpace](#class-iuserspace)
    - [iUserSpace](#iuserspace)
    - [createUserSpace](#createuserspace)
    - [setUserSpaceData](#setuserspacedata)
    - [getUserSpaceData](#getuserspacedata)
    - [deleteUserSpace](#deleteuserspace)
  - [Class iNetwork](#class-inetwork)
    - [iNetwork](#inetwork)
    - [getTCPIPAttr](#gettcpipattr)
    - [getNetInterfaceData](#getnetinterfacedata)
  - [Class iObj](#class-iobj)
    - [iObj](#iobj)
    - [retrUsrAuth](#retrusrauth)
    - [retrCmdInfo](#retrcmdinfo)
    - [retrPgmInfo](#retrpgminfo)
    - [retrSrvPgmInfo](#retrsrvpgminfo)
    - [retrUserInfo](#retruserinfo)
    - [retrUserAuthToObj](#retruserauthtoobj)
    - [addToLibraryList](#addtolibrarylist)
    - [Class iDataQueue](#class-idataqueue)
  - [iDataQueue](#idataqueue)
    - [sendToDataQueue](#sendtodataqueue)
    - [receiveFromDataQueue](#receivefromdataqueue)
    - [clearDataQueue](#cleardataqueue)

# Introduction

Node.js Toolkit for IBM i is a JavaScript API set for IBM i. It requires the XML Service for IBM i. You can apply group PTF SF99368 - level 31 for i 7.1 and SF99713 - level 5 for i 7.2 to get this feature. XML service receives requests in the XML format and respond output also in the XML format. For example, to retrieve the values of job attributes on IBM i. If we send below XML request to XML service --

```xml
<?xml version='1.0'?>

<myscript>

<cmd exec='rexx'>RTVJOBA USRLIBL(?) SYSLIBL(?)</cmd>

</myscript>
```

Then XML service will run the command and send the response back to client as below –

```xml
<?xml version='1.0'?>

<myscript>

<cmd exec='rexx'>

<success>+++ success RTVJOBA USRLIBL(?) SYSLIBL(?)</success>

<row>

<data desc='USRLIBL'>QGPL  QTEMP </data>

</row>

<row>

<data desc='SYSLIBL'>QSYS  QSYS2  QHLPSYS  QUSRSYS</data>

</row>

</cmd>

</myscript>
```

Node.js Toolkit for IBM i provides several Javascript API to easily build the XML requests and parse the output.

To install from npm :

```bash
npm install itoolkit
```

To use the this add-on, you need to require the itoolkit.js file in your source code and make a new connection object with the required parameters (database entry name, the user profile and the password). This is the basic file used by other system API.

 

For most of following system classes, there are two ways to handle the output of XML service – synchronous mode and asynchronous mode.

For synchronous mode, the API waits for completion up to 5 seconds (This default timeout value can be changed by setTimeout() method) to get the output. 

For asynchronous mode, the API invokes the call back function once the process completed.

```js
// synchronous mode
console.log("QCCSID = " + work.getSysValue("QCCSID"));

// asynchronous mode
work.getSysValue("QCCSID", function(rs) {
    console.log("QCCSID = " + rs);
});
```


## Global Object itoolkit

### xmlToJson

**Description:**
Convert the output XML document into JSON format. The response data of XML service is always a XML document, so it is necessary to convert it to a JSON object which is more compatible with the Java script language.

**Syntax:**
xmlToJson(string xml)

**Parameters:**

- xml `<string>` The response generated by XML service program.

**Returns:**
Returns a JSON object that can be easily used by JavaScript. The function parses and flats the XML output so the JSON data structure is different. The keywords of the JSON object are listed below:

| Field   | Description |
| -----   | ----------- |
| type    | cmd – The output corresponds to an iCmd request.<br>sh – The output corresponds to an iSh request. <br> pgm – The output corresponds to an iPgm request.<br>sql – The output corresponds to an iSql request. |
| success | true – The command is executed successfully.<br>false – Some error happens when executed the command.<br>Note: iSh output does not contain this field. |
| data    |For iCmd, iPgm or iSql, it is a Javascript array containing the output data or execution result. There are two fields for each item in the array.<br>For iCmd, the two fields are "name" and "value". For example, {"name": "SYSLIBL", "value": "QSYS"}.<br>For iPgm, the two fields are "type" and "value". For example, {"type": "10i0",  "value": "16"}.<br>For iSql, the two fields are "desc" and "value". For example, {"desc": "LSTNAM", "value": "Henning"}.<br>For iSh, this is a simple string object. |
| cmd     | The specified command of iCmd. |
| pgm     | The specified program or service program of iPgm. |
| lib     | The library of specified program or service program of iPgm. |
| stmt    | The specified statement of iSql. |

**Example:**

```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

conn.add(xt.iCmd("RTVJOBA USRLIBL(?) SYSLIBL(?)"));

function cbJson(str) {
    console.log("The raw XML output --- ");

    console.log(str);  // Print the raw XML output

    console.log("The formatted JSON output --- ");

    console.log(JSON.stringify(xt.xmlToJson(str), null, 4));  // Print the formatted JSON output

}

conn.run(cbJson);
```

Expected Result:

The raw XML output ---

```xml
<?xml version='1.0'?><myscript><cmd exec='rexx' error='fast'><success>+++ success RTVJOBA USRLIBL(?) SYSLIBL(?)</success>

<row>

<data desc='USRLIBL'>QGPL  QTEMP</data>

</row>

<row>

<data desc='SYSLIBL'>QSYS  QSYS2  QHLPSYS  QUSRSYS</data>

</row>

</cmd>

</myscript>
```

The formatted JSON output ---

```json
[

    {
        "type": "cmd",

        "success": true,

        "cmd": "RTVJOBA USRLIBL(?) SYSLIBL(?)",

        "data": [

            {
                "name": "USRLIBL",

                "value": "QGPL  QTEMP"

            },

            {
                "name": "SYSLIBL",

                "value": "QSYS  QSYS2  QHLPSYS  QUSRSYS"

            }

        ]

    }

]
```


### iCmd
**Description:**

Construct a CL command request string. It is recommended to read the "XMLSERVICE call CMD" part of the [XML service manual](http://youngiprofessionals.com/wiki/index.php/XMLSERVICE/XMLSERVICE) first.



**Syntax:**

iCmd(string cmd[, object options])


**Parameters:**
- cmd `<string>` the CL command in one line (no LFs).
  - All parameters are assume to be character unless (?N) to explicit cast to numeric. 
  - Most RTVxxxx that ask for a CL variable RTNVAR will not require the (?N) cast.
- options `<object>` The optional parameter indicating how to process the command.

| Field   | Type   | Description |
| -----   | ----   | ----------- |
| exec    | string | cmd - cmd only return true/false<br>system - system utility return CPFxxxx<br>rexx - return output parms and CPFxxxx | 
| error   | string | on - script stops, full error report<br>off - script continues, job error log (default)<br>fast - script continues, brief error log |
| hex     | string | on - output value is in raw hex format<br>off - output value is encoded by CCSID (default) |
| before  | string | Convert to this CCSID before system call. |
| after   | string | Convert output of system call to this CCSID. |


**Returns:**
TODO missing returns


**Example:**

```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

conn.add(xt.iCmd("RTVJOBA USRLIBL(?) SYSLIBL(?)"));

function cb(str) {console.log(str);}

conn.run(cb);

```

### iSh

**Description:**

Construct a QShell command request string. It is recommended to read the "XMLSERVICE call PASE" part of the [XML service manual](http://youngiprofessionals.com/wiki/index.php/XMLSERVICE/XMLSERVICE) first.


**Syntax:**

iSh(string cmd[, object options])



**Parameters:**

- cmd `<string>` The QShell command.

- options `<object>` The optional parameter indicating how to process the command.

| Field   | Type   | Description |
| -----   | ----   | ----------- |
| rows    | string | on - split the output row by row<br>off - the output is a block of text (default) |
| error   | string | on - script stops, full error report<br>off - script continues, job error log (default)<br>fast - script continues, brief error log |
| hex     | string | on - output value is in raw hex format <br> off - output value is encoded by CCSID (default) |
| before  | string | Convert to this CCSID before system call. |
| after   | string | Convert output of system call to this CCSID. |

**Returns:**

TODO

**Example:**

```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

conn.add(xt.iSh("system -i wrksyssts"));

function cb(str) {console.log(str);}

conn.run(cb);
```

## Class iConn

### iConn

**Description:**

Returns the connection object representing the target IBM i system. The object is used to transport data to XML service. There are two transport methods – RESTful and DB2 stored procedures.

For the RESTful transport, a HTTP server with following CGI configuration should be ready in advance.

```
ScriptAlias /cgi-bin/ /QSYS.LIB/QXMLSERV.LIB/

<Directory /QSYS.LIB/QXMLSERV.LIB/>

  Require all granted

  SetHandler cgi-script

  Options +ExecCGI

</Directory>
```
And then Toolkit can send HTTP requests to the XML service CGI program /cgi-bin/xmlcgi.pgm to get response.

For the DB2 stored procedures transport, a database connection will be established and the requests will be handled by the DB2 stored procedures QXMLSERV.iPLUGxxxx(). In this mode, no HTTP server is required.

The DB2 stored procedures transport is used by default. But if the host field of the optional parameter options is available, then the RESTful tranport will be used.

**Syntax:**

iConn(string dataSource[, string user, string password[,object options]])

**Parameters:**
- dataSource `<string>` Name or alias name of the database.
  - You may issue CL command `WRKRDBDIRE` to get the Entry names.
  - Or simply use `*LOCAL` to connect to the local database.
- user `<string>` User profile for IBM i authorization. It is a user profile on IBM i.
- password `<string>` The password of specified user profile.
- options `<object>` A JavaScript object representing the connection options.

| Field   | Type    | Description |
| -----   | ----    | ----------- |
| host    | string  | The IP/host name of remote system. If this field is undefined, toolkit will connect to the DB2 stored procedures rather than REST way. |
| port    | integer | The listening port of the REST server. |
| path    | string  | The path of the XML service CGI program. |
| ctl     | string  | Control keywords for operator control over XML service jobs. |
| ipc     | string  | IPC key name/security route to XML service job. |
| buf     | integer | Size of output xml buffer |
| xslib   | string  | XML Service library name. If this field is undefined, the default library QXMLSERV will be used. |


**Returns:**

`<object>` a connection object that can be used to post XML service requests.

**Example:**

```js
var xt = require("itoolkit");

var option = {
    host : "192.168.1.101",
    port : 8080,
    path : "/cgi-bin/xmlcgi.pgm"
};

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");  // DB2

var conn2 = new xt.iConn("*LOCAL", "USER", "PASSWORD", option); // REST

```

### debug

**Description:**

Enable or disable the verbose mode for debugging. If the verbose mode is enabled, the input XML data will be printed.

**Syntax:**

Syntax 1: debug(Boolean OnOff)

Syntax 2: 

**Parameters:**

- OnOff `<boolean>`

if false(default) -- debugging information will not be printed.

if true -- debugging information will be printed.

**Returns:**

For Syntax 1, it returns a Boolean value indicating whether verbose mode is enabled or not.

**Example:**

```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

conn.debug(true);

conn.add(xt.iCmd("RTVJOBA USRLIBL(?) SYSLIBL(?)"));

function cb(str) {console.log(str);}

conn.run(cb);
```


### add
**Description:**

Add an IBM i call to the command list.

**Syntax:**

add(object call)

**Parameters:**

- call `<object> | <string>` an instance of class iCmd(CL command), iPgm(IBM i program or service program), iSh(QShell command) or iSql(SQL statement).

**Example:**

```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

conn.add(xt.iCmd("RTVJOBA USRLIBL(?) SYSLIBL(?)"));

conn.add(xt.iSh("system -i wrksyssts"));

conn.add(…)

function cb(str) {console.log(str);}

conn.run(cb);
```

**Returns:**
TODO

### run
**Description:**

Run the commands in the command list one by one.

**Syntax:**

run(function callback(output))

**Parameters:**

- callback `<function>` The specified call back function to handle the execution result. output is the output XML document from XML service program.

**Returns:**
TODO

**Example:**

Refer to the [iSh example]().



### getConnection

**Description:**

Returns current attached connection object.

**Syntax:**

getConnection()

**Returns:**

`<object>` connection object representing current connection. Following fields can be retrieved from the output object.


| Field   | Description |
| -----   | ----------- |
| I_TRANSPORT_DB2_DATABASE | Name or alias name of the database. |
| I_TRANSPORT_DB2_USER     | The database user. |
| I_TRANSPORT              | The transport to XML Service(REST or DB2) |
| I_TRANSPORT_REST_HOST    | The IP/host name of remote system. |
| I_TRANSPORT_REST_PORT    | The listening port of the REST server. |
| I_TRANSPORT_REST_PATH    | The path of the XML service CGI program. |
| I_XML_SERVICE_LIB        | The XML Service library name. |


**Example:**

```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

console.log("Current XML Service Library is : ");

console.log(conn.getConnection().I_XML_SERVICE_LIB);
```

### setTimeout
**Description:**

Override the default timeout value (5 seconds) for synchronous mode. .

**Syntax:**

setTimeout(int seconds)

**Example:**

```js
var xt = require("itoolkit");

xt.setTimeout(3);
```


## Class iPgm

### iPgm
**Description:**

Construct a new IBM i program/service program call object. Node.js Toolkit for IBM i calls programs/service programs via XML service compatible requests. Unlike iSh or iCmd requests, iPgm requests are more complicated. It is recommended to read the "XMLSERVICE call PGM" part of the [XML service manual](http://youngiprofessionals.com/wiki/index.php/XMLSERVICE/XMLSERVICE) first. And you may find the system programs API manual at [Knowledge Center](https://www.ibm.com/support/knowledgecenter/ssw_ibm_i_72/apis/aplist.htm).

The data type of iPgm parameter is similar to the RPG language. So you may see some data type definitions like "10A" or "10i0" in following examples. Following is an example to get system value QCCSID using an iPgm request. We can find the corresponding data types from this example.


```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL");

var sysVal = "QCCSID";

var outBuf = [

       [0, "10i0"],

       [0, "10i0"],

       ["", "10A"],

       ["", "1A"],

       ["", "1A"],

       [0, "10i0"],

       [0, "10i0"]

];

var errno = [

       [0, "10i0"],

       [0, "10i0", {"setlen":"rec2"}],

       ["", "7A"],

       ["", "1A"]

];

var pgm = new xt.iPgm("QWCRSVAL", {"lib":"QSYS"});

pgm.addParam(outBuf, {"io":"out", "len":"rec1"});

pgm.addParam(0, "10i0", {"setlen":"rec1"});

pgm.addParam(1, "10i0");

pgm.addParam(sysVal, "10A");

pgm.addParam(errno, {"io":"both", "len" : "rec2"});

console.log(pgm.toXML());

 

function cb (str) {
       console.log(str);  // Print the raw XML output

}

conn.add(pgm);

conn.run(cb);
```


Actually Node.js Toolkit parses above parameters and builds below XML document which will be sent to XML service as a request.

 
```xml
<?xml version='1.0'?>

<myscript>

<pgm name='QWCRSVAL' lib='QSYS' error='fast'>

       <parm io='out'>

              <ds len='rec1'>

                     <data type='10i0'>0</data>

                     <data type='10i0'>0</data>

                     <data type='10A'></data>

                     <data type='1A'></data>

                     <data type='1A'></data>

                     <data type='10i0'>0</data>

                     <data type='10i0'>0</data>

              </ds>

       </parm>

       <parm>

              <data type='10i0' setlen='rec1'>0</data>

       </parm>

       <parm>

              <data type='10i0'>1</data>

       </parm>

       <parm>

              <data type='10A'>QCCSID</data>

       </parm>

       <parm io='both'>

              <ds len='rec2'>

                     <data type='10i0'>0</data>

                     <data type='10i0' setlen='rec2'>0</data>

                     <data type='7A'></data>

                     <data type='1A'></data>

              </ds>

       </parm>

</pgm>

</myscript>
```

And if the request is successfully executed, below response will be sent by XML service. We can see that the empty array has been filled with meaningful data. And the data we want (37) in the output array.

```xml
<?xml version='1.0'?>

<myscript>

<pgm name='QWCRSVAL' lib='QSYS' error='fast'>

       <parm io='out'>

              <ds len='rec1'>

                     <data type='10i0'>1</data>

                     <data type='10i0'>8</data>

                     <data type='10A'>QCCSID</data>

                     <data type='1A'>B</data>

                     <data type='1A'></data>

                     <data type='10i0'>4</data>

                     <data type='10i0'>37</data>

              </ds>

       </parm>

       <parm>

              <data type='10i0' setlen='rec1'>28</data>

       </parm>

       <parm>

              <data type='10i0'>1</data>

       </parm>

       <parm>

              <data type='10A'>QCCSID</data>

       </parm>

       <parm io='both'>

              <ds len='rec2'>

                     <data type='10i0'>0</data>

                     <data type='10i0' setlen='rec2'>16</data>

                     <data type='7A'></data>

                     <data type='1A'></data>

              </ds>

       </parm>

       <success><![CDATA[+++ success QSYS QWCRSVAL ]]></success>

</pgm>

</myscript>
```

To represent nested date structure, iPgm supports parsing nested Javascript arrays. In above example, the system value information parameter is defined in Knowledge Center as below

TODO get this table right


| Dec | Hex | Type | Field |
| --- | --- | ---- | ----- |
|  0  |  0  | BINARY(4)    | Number of system values returned |
|  4  |  4  | BINARY(4)    | Offset to system value information table |
|  0  |  0  | CHAR(10)     | System value |
|  10 |  A  | CHAR(1)      | Type of data |
|  11 |  B  | CHAR(1)      | Information status |
|  12 |  C  | BINARY(4)    | Length of data |
|  16 |  10 | CHAR(*)      | Data -- QCCSID has a type of BINARY(4) |




The corresonding XML service definition is:

```xml
<ds len='rec1'>

       <data type='10i0'>0</data>

       <data type='10i0'>0</data>

       <data type='10A'></data>

       <data type='1A'></data>

       <data type='1A'></data>

       <data type='10i0'>0</data>

       <data type='10i0'>0</data>

</ds>
```

And the Javascript code for iPgm is:

```js
var outBuf = [

       [0, "10i0"],

       [0, "10i0"],

       ["", "10A"],

       ["", "1A"],

       ["", "1A"],

       [0, "10i0"],

       [0, "10i0"]

];
```

XML service provides two useful keywords "len" and "setlen" to automatically calculate and set the size of target data structure. For more information, please refer to the [XML service manual](http://youngiprofessionals.com/wiki/index.php/XMLSERVICE/XMLSERVICE).

**Syntax:**

newPgm(string pgm[, object options])

**Parameters:**
- pgm `<string>` The target IBM i program / service program.

- options `<object>` The optional parameter indicating how to process the command.


| Field | Type   | Description |
| ----- | ------ | ----------- |
| lib   | string | The library where the program exists. |
| error | string | on - script stops, full error report<br>off - script continues, job error log (default)<br>fast - script continues, brief error log |
| func  | string | The target function of the service program |
| mode  | string | opm - uses non-teraspace to build parm lists<br>ile - default using teraspace for "mixed" memory |

**Example:**

```js
// This example shows how to call a function in a service program.

var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL");

var sysVal = "QCCSID";

var errno = [

    [0, "10i0"],

    [0, "10i0", {"setlen":"rec2"}],

    ["", "7A"],

    ["", "1A"]

];

var outBuf = [

    [0, "10i0"],     // [0] Bytes returned

    [0, "10i0"],     // [1] Bytes available

    [0, "10i0"],     // [2] TCP/IPv4 stack status

    [0, "10i0"],     // [3] How long active

    ["", "8A"],     // [4] When last started - date

    ["", "6A"],     // [5] When last started - time

    ["", "8A"],     // [6] When last ended - date

    ["", "6A"],     // [7] When last ended - time

    ["", "10A"],    // [8] Who last started - job name

    ["", "10A"],    // [9] Who last started - job user name

    ["", "6A"],     // [10] Who last started - job number

    ["", "16h"],    // [11] Who last started - internal job identifier

    ["", "10A"],    // [12] Who last ended - job name

    ["", "10A"],    // [13] Who last ended - job user name

    ["", "6A"],     // [14] Who last ended - job number

    ["", "16h"],    // [15] Who last ended - internal job identifier

    [0, "10i0"],     // [16] Offset to additional information

    [0, "10i0"],     // [17] Length of additional information

    [0, "10i0"],     // [18] Limited mode

    [0, "10i0"],     // [19] Offset to list of Internet addresses

    [0, "10i0"],     // [20] Number of Internet addresses

    [0, "10i0"],     // [21] Entry length for list of Internet addresses

    [0, "10i0"],     // [22] DNS protocol

    [0, "10i0"],     // [23] Retries

    [0, "10i0"],     // [24] Time interval

    [0, "10i0"],     // [25] Search order

    [0, "10i0"],     // [26] Initial domain name server

    [0, "10i0"],     // [27] DNS listening port

    ["", "64A"],    // [28] Host name

    ["", "255A"],  // [29] Domain name

    ["", "1A"],     // [30] Reserved

    ["", "256A"],  // [31] Domain search list

];

var pgm = new xt.iPgm("QTOCNETSTS", {"lib":"QSYS","func":"QtocRtvTCPA"});

pgm.addParam(outBuf, {"io":"out", "len":"rec1"});

pgm.addParam(0, "10i0", {"setlen":"rec1"});

pgm.addParam("TCPA0300", "8A");

pgm.addParam(errno, {"io":"both", "len" : "rec2"});

conn.add(pgm);

function cb(str) {console.log("Host name is : " + xt.xmlToJson(str)[0].data[28].value);}

conn.run(cb);
```

### addParam
**Description:**

Add a new parameter element to current iPgm object.

**Syntax 1:**


addParam(string value, string type[, object options])

**Syntax 2:**

addParam(array value, [, object options])

**Parameters:**
- value `<string>` The parameter element value. If the parameter is a complex structure, then use syntax 2. For syntax 2, each element in array value has its own type.
  
- type `<string>` The parameter data type.

| Type | Description      | Example           |
| ---- | ---------------- | ----------------- |
| na   | character        | hello world (32a) |
| npn  | packed decimal   | 30.29 (12p2)      |
| nsn  | zoned decimal    | 30.29 (12s2)      |
| nin  | signed integer   | -30 (10i0)        |
| nun  | unsigned integer | 30 (10u0)         |
| nfn  | floating point   | 30.34 (4f2)       |
| nb   | binary HEX char | F0F1F2CDEF (5b)    |

- options `<object>` Indicates the properties of the parameter.

| Field   | Type    | Description  |
| ----    | ------  | ------------ |
| dim     | integer | 'n'          |
| varying | string  | 'on|off|2|4' |
| enddo   | string  | 'label'      |
| setlen  | string  | Set the value with automatically calculated data structure length. |
| offset  | string  | 'label' |
| trim    | string  | 'on|off' |
| hex     | string  | on - output value is in raw hex format<br>off - output value is encoded by CCSID (default) |
| before  | string  | Convert to this CCSID before system call. |
| after   | string  | Convert output to this CCSID. |


**Example:**

TODO add link iPgm

Refer to the [iPgm](#ipgm) example.

### addReturn

**Description:**

Add a new returned element to current iPgm object.

**Syntax:**

addReturn(string value, string type[, object options])

**Example:**

```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var pgm = new xt.iPgm("ZZCALL", {"lib":"XMLSERVICE"});

pgm.addParam("a", "1A");

pgm.addReturn("0", "20A");

conn.add(pgm);

function cb(str) {console.log(str);}

conn.run(cb);
```

### toXML
**Description:**

Convert current iPgm object into XML format which can be used for debug purpose.

**Syntax:**

toXML()

**Example:**

```js
var xt = require("itoolkit");

var sysVal = "QCCSID";

var errno = [

    [0, "10i0"],

    [0, "10i0", {"setlen":"rec2"}],

    ["", "7A"],

    ["", "1A"]

];

var outBuf = [

    [0, "10i0"],

    [0, "10i0"],

    ["", "10A"],

    ["", "1A"],

    ["", "1A"],

    [0, "10i0"],

    [0, "10i0"]

];

var pgm = new xt.iPgm("QWCRSVAL", {"lib":"QSYS"});

pgm.addParam(outBuf, {"io":"out", "len":"rec1"});

pgm.addParam(0, "10i0", {"setlen":"rec1"});

pgm.addParam(1, "10i0");

pgm.addParam(sysVal, "10A");

pgm.addParam(errno, {"io":"both", "len" : "rec2"});

console.log(pgm.toXML());
```
Expected Result:

```xml
<pgm name='QWCRSVAL' lib='QSYS' error='fast'>

<parm io='out'><ds len='rec1'>

<data type='10i0'>0</data>

<data type='10i0'>0</data>

<data type='10A'></data>

<data type='1A'></data>

<data type='1A'></data>

<data type='10i0'>0</data>

<data type='10i0'>0</data></ds></parm>

<parm><data type='10i0' setlen='rec1'>0</data></parm>

<parm><data type='10i0'>1</data></parm>

<parm><data type='10A'>QCCSID</data></parm>

<parm io='both'><ds len='rec2'>

<data type='10i0'>0</data>

<data type='10i0' setlen='rec2'>0</data>

<data type='7A'></data>

<data type='1A'></data></ds></parm></pgm>
```

### Class iSql

## iSql

**Description:**

Construct a new SQL statement object. It is recommended to read the "XMLSERVICE DB2 SQL" part of the XML service manual first.

Note: Some methods ( fetch(), free(), etc. ) of class iSql look like realy SQL actions, but they really just build the XML request. The SQL statements are really executed when the XML request is submitted to XML service.

**Syntax:**

newSql([object options])

**Parameters:**
- options `<object>` The optional parameter indicating how to process the command.


| <!-- -->   | <!-- --> | <!-- -->                                                     |
| ---------- | -------  | -------                                                      |
| timesep    | string   | 'colon|period|comma|blank|job' (default=na)                  |
| decimalsep | string   | 'period|comma|blank|job' (default=na)                        |
| optimize   | string   | 'first|all' (default=na)                                     |
| scrollable | string   | 'on|off' (default=off)                                       |
| sensitive  | string   | 'unspecified|sensitive|insensitive'<br>(default=unspecified) |
| cursor     | string   | 'forward|static|dynamic'<br>(default=forward)                |
| fetchonly  | string   | 'on|off' (default=on)                                        |
| fullopen   | string   | 'on|off' (default=off)                                       |


**Example:**

```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var sql = new xt.iSql();

sql.addQuery("SELECT LSTNAM, STATE FROM QIWS.QCUSTCDT");

sql.fetch();

sql.free();

conn.add(sql);

function cb(str) {console.log(JSON.stringify(xt.xmlToJson(str)[0].result));}

conn.run(cb);

Expected Result:

 [[{"desc":"LSTNAM","value":"Henning"},{"desc":"STATE","value":"TX"}],

[{"desc":"LSTNAM","value":"Jones"},{"desc":"STATE","value":"NY"}],

[{"desc":"LSTNAM","value":"Vine"},{"desc":"STATE","value":"VT"}],

[{"desc":"LSTNAM","value":"Johnson"},{"desc":"STATE","value":"GA"}],

[{"desc":"LSTNAM","value":"Tyron"},{"desc":"STATE","value":"NY"}],

[{"desc":"LSTNAM","value":"Stevens"},{"desc":"STATE","value":"CO"}],

[{"desc":"LSTNAM","value":"Alison"},{"desc":"STATE","value":"MN"}],

[{"desc":"LSTNAM","value":"Doe"},{"desc":"STATE","value":"CA"}],

[{"desc":"LSTNAM","value":"Thomas"},{"desc":"STATE","value":"WY"}],

[{"desc":"LSTNAM","value":"Williams"},{"desc":"STATE","value":"TX"}],

[{"desc":"LSTNAM","value":"Lee"},{"desc":"STATE","value":"NY"}],

[{"desc":"LSTNAM","value":"Abraham"},{"desc":"STATE","value":"MN"}]]        
```

### addQuery

**Description:**

Execute statement directly.

**Syntax:**

addQuery(string statement[, object options])

**Parameters:**
- statement `<string>` The SQL statement.

**Example:**

TODO add link
Refer to the iSql example.



### fetch

**Description:**

Fetch result(s) of a statement.

**Syntax:**

fetch(object options)

**Parameters:**
- options `<object>`

| Field      | Type    | Description |
| ----       | ------- | -------     |
| stmt       | string  | The label of the statement |
| block      | string  | 'all|n' (default=all) |
| rec        | integer | 'n'                   |
| desc       | string  | 'on|off' (default=on) |
| error      | string  | on - script stops, full error report<br>off - script continues, job error log (default)<br>fast - script continues, brief error log |


**Example:**

TODO add link
Refer to the iSql example.


### commit

**Description:**

Commit or rollback transaction.

**Syntax:**

commit(object options)

**Parameters:**
- options `<object>` 

| Field      | Type    | Description |
| ----       | ------- | -------     |
| action     | string  | commit - Commit the operations.<br>rollback - Rollback the operations. |
| error      | string  | on - script stops, full error repor<br>off - script continues, job error log (default)<br>fast - script continues, brief error log |


### prepare
**Description:**

Prepare a SQL statement.

**Syntax:**

prepare(string statement[, object options])

**Parameters:**

- statement `<string>` The SQL statement.

- options `<object>`

| Field      | Type    | Description |
| ----       | ------- | -------     |
| error      | string  | on - script stops, full error report<br>off - script continues, job error log (default)<br>fast - script continues, brief error log |


**Example:**

```js
var xt = require("itoolkit");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var sql = new xt.iSql();

sql.prepare("call qsys2.tcpip_info()");

sql.execute();

sql.fetch();

sql.free();

conn.add(sql);

function cb(str) {console.log(JSON.stringify(xt.xmlToJson(str));}

conn.run(cb);

Expected Result:

[{"type":"sql","success":true,"stmt":"call qsys2.tcpip_info()]]>","result":[

[{"desc":"HOSTNAME","value":"LP106UT27.RCH.STGLABS.IBM.COM"},

{"desc":"VRM","value":"V7R2M0"},

{"desc":"DBGROUP","value":"SF99702 03"},

{"desc":"IPTYPE","value":"NONE"},

{"desc":"IPADDR","value":"UNKNOWN"},

{"desc":"PORT","value":"0"}]]}]
```


### execute

**Description:**

Execute a prepared statement.

**Syntax:**

execute([array params[, object options]])

**Parameters:**
- params `<array>` The parameter list. Each item of the list contains two field:
   - io - in|out|both'
   - value - The value of the parameter.

- options `<object>` 

| Field      | Type    | Description |
| ----       | ------- | -------     |
| error      | string  | on - script stops, full error report<br>off - script continues, job error log (default)<br>fast - script continues, brief error log |


**Example:**

TODO add link

Refer to the prepare example.



## Class iWork

### iWork

**Description:**

Construct a new iWork object.

**Syntax:**

iWork(iConn conn)

**Parameters:**
- conn `<object>` An iConn object representing the target IBM i system.

**Example:**

```js
var xt = require("itoolkit");

var wk = require("itoolkit/work");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var work = new wk.iWork(conn);
```


### getSysValue

**Description:**

Get specified system value.

**Syntax:**

getSysValue (string sysval[, function callback(output)])

**Parameters:**
- sysval `<string>` The system value name to be queried.

- callback `<function>` The callback function to handle the output for asynchronous mode.

IBM i API:

QWCRSVAL

**Example:**

```js
var xt = require("itoolkit");

var wk = require("itoolkit/iwork");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var work = new wk.iWork(conn);

work.getSysValue("QCCSID", function(output) {
console.log("QCCSID = " + output);});  // asynchronous mode

console.log("QCCSID = " + work.getSysValue("QCCSID"));  // synchronous mode
```


### getSysStatus

**Description:**

Get basic system status.

**Syntax:**

getSysStatus ( [function callback(output)])

**Parameters:**
- callback `<function>` The callback function to handle the output for asynchronous mode.

IBM i API:

QWCRSSTS

**Example:**

```js
var xt = require("itoolkit");

var wk = require("itoolkit/iwork");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var work = new wk.iWork(conn);

work.getSysStatus(function(output) {
console.log(JSON.stringify(output));});  // asynchronous

console.log(JSON.stringify(work.getSysStatus()));  // synchronous
```
**Output Fields:**

| Index       | Field                                                 |
| -----       | -----                                                 |
| 0           | Current date and time                                 |
| 1           | System name                                           |
| 2           | Users currently signed on                             |
| 3           | Users temporarily signed off (disconnected)           |
| 4           | Users suspended by system request                     | 
| 5           | Users suspended by group jobs                         |
| 6           | Users signed off with printer output waiting to print |
| 7           | Batch jobs waiting for messages                       |
| 8           | Batch jobs running                                    | 
| 9           | Batch jobs held while running                         |
| 10          | Batch jobs ending                                     |
| 11          | Batch jobs waiting to run or already scheduled        |
| 12          | Batch jobs held on a job queue                        |
| 13          | Batch jobs on a held job queue                        |
| 10          | Batch jobs on an unassigned job queue                 |
| 15          | Batch jobs ended with printer output waiting to print |


### getSysStatusExt

**Description:**

Get detailed system status.

**Syntax:**

getSysStatusExt ( [function callback(output)])

**Parameters:**

- callback `<function>` The callback function to handle the output for asynchronous mode.

IBM i API:

QWCRSSTS

**Example:**

```js
var xt = require("itoolkit");

var wk = require("itoolkit/iwork");

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var work = new wk.iWork(conn);

console.log(JSON.stringify(work.getSysStatusExt()));
```
**Output Fields:**

| Index       | Field                             |
| -----       | -----                             |
| 0           | Current date and time             |
| 1           | System name                       |
| 2           | Elapsed time                      |
| 3           | Restricted state flag             |
| 4           | % processing unit used            |
| 5           | Jobs in system                    |
| 6           | % permanent addresses             |
| 7           | % temporary addresses             |
| 8           | System ASP                        |
| 9           | % system ASP used                 |
| 10          | Total auxiliary storage           |
| 11          | Current unprotected storage used  |
| 12          | Maximum unprotected storage used  |
| 13          | % DB capability                   |
| 10          | Main storage size                 |
| 15          | Number of partitions              |
| 16          | Partition identifier              |
| 17          | Current processing capacity       |
| 18          | Processor sharing attribute       |
| 19          | Number of processors              |
| 20          | Active jobs in system             |
| 21          | Active threads in system          |
| 22          | Maximum jobs in system            |
| 23          | % temporary 256MB segments used   |
| 24          | % temporary 4GB segments used     |
| 25          | % permanent 256MB segments used   |
| 26          | % permanent 4GB segments used     |
| 27          | % current interactive performance |
| 28          | % uncapped CPU capacity used      |
| 29          | % shared processor pool used      |
| 30          | Main storage size (long)          |


### getJobStatus

**Description:**

Get detailed system status.

**Syntax:**

getSysStatusExt ( [function callback(output)])

**Parameters:**

**Description:**

Get specified job’s status.

**Syntax:**

getJobStatus ( string jobID[, function callback(output)])

**Parameters:**

- jobid `<string>` A specific job number(6 characters max)

- callback `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QWCRJBST

**Example:**

```js
var xt = require("itoolkit");

var wk = require('itoolkit/iWork');

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var work = new wk.iWork(conn);

console.log(JSON.stringify(work.getJobStatus("401061")));
```
**Output Fields:**

| Index       | Field                    |
| -----       | -----                    |
| 0           | Job status               |
| 1           | Fully qualified job name |

Index

Field

0

Job status

1

Fully qualified job name



### getJobInfo

**Description:**

Get specified job’s status.

**Syntax:**

getJobInfo ( string jobName, string userName, string jobID[, function cb(output)])

**Parameters:**
- jobName `<string>` A specific job name (10 characters max)

- userName `<string>` A specific user profile name (10 characters max)

- jobNumber `<string>` A specific job number (6 characters max)

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QUSRJOBI

**Example:**

```js
var xt = require("itoolkit");

var wk = require('itoolkit/iWork');

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var work = new wk.iWork(conn);

console.log(JSON.stringify(work.getJobInfo("TEST", "QTMHHTTP", "401061")));
```
**Output Fields:**

| Index        | Field                                                                        |
| -----        | -----                                                                        |
| 0            | Job name                                                                     |
| 1            | User name                                                                    |
| 2            | Job number                                                                   |
| 3            | Job status                                                                   |
| 4            | Job type                                                                     |
| 5            | Job subtype                                                                  |
| 6            | Subsystem description name                                                   |
| 7            | Run priority (job)                                                           |
| 8            | System pool identifier                                                       |
| 9            | Processing unit time used, if less than 2,147,483,647 milliseconds           |
| 10           | Number of auxiliary I/O requests, if less than 2,147,483,647                 |
| 11           | Number of interactive transactions                                           |
| 12           | Response time total                                                          |
| 13           | Function type                                                                |
| 14           | Function name                                                                |
| 15           | Active job status                                                            |
| 16           | Number of database lock waits                                                |
| 17           | Number of internal machine lock waits                                        |
| 18           | Number of nondatabase lock waits                                             |
| 19           | Time spent on database lock waits                                            |
| 20           | Time spent on internal machine lock waits                                    |
| 21           | Time spent on nondatabase lock waits                                         |
| 22           | Current system pool identifier                                               |
| 23           | Thread count                                                                 |
| 24           | Processing unit time used - total for the job                                |
| 25           | Number of auxiliary I/O requests                                             |
| 26           | Processing unit time used for database - total for the job                   |
| 27           | Page faults                                                                  |
| 28           | Active job status for jobs ending                                            |
| 29           | Memory pool name                                                             |
| 30           | Message reply                                                                |
| 31           | Message key, when active job waiting for a message                           |
| 32           | Message queue name, when active job waiting for a message                    |
| 33           | Message queue library name, when active job waiting for a message            |
| 34           | Message queue library ASP device name, when active job waiting for a message |


### getDataArea

**Description:**

Retrieve the contents of a data area.

**Syntax:**

getDataArea ( string lib, string area, int length[, function cb(output)])

**Parameters:**

- lib `<string>` Name of the library where the data area is located (10 characters max).

- area `<string>` The data area name (10 characters max)

- length `<number>` The length of the data area substring to be retrieved. The length of data parameter must be greater than 0. If the length of data parameter is greater than the size of the data area, the receiver variable is padded with blanks.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QWCRDTAA

**Example:**

```js
var xt = require("itoolkit");

var wk = require('itoolkit/iWork');

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var work = new wk.iWork(conn);

console.log(JSON.stringify(work.getDataArea("", "*LDA", 100)));
```
**Output Fields:**

| Index  | Field                       |
| -----  | -----                       |
| 0      | Type of value returned      |
| 1      | Library name                |
| 2      | Length of value returned    |
| 3      | Number of decimal positions |
| 4      | Value                       |

## Class iProd

### iProd
**Description:**

Construct a new iProd object.

**Syntax:**

iProd(iConn conn)

**Parameters:**

- conn `<object>` An iConn object representing the target IBM i system.

**Example:**

```js
var xt = require("itoolkit");

var pd = require('itoolkit/iProd');

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var prod = new pd.iProd(conn);
```


### getPTFInfo

**Description:**

Get the load status of specified PTF.

**Syntax:**

getPTFInfo (string PTFNum[, function callback(output)])

**Parameters:**
- PTFNum `<string>` The PTF number to be queried.

- callback `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QPZRTVFX

**Example:**

```js
var xt = require("itoolkit");

var pd = require('itoolkit/iProd');

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var prod = new pd.iProd(conn);

console.log(JSON.stringify(prod.getPTFInfo("SI54708")));
```
**Output Fields:**


| Index         | Field                         |
| -----        | -----                          |
| 0            | Product ID                     |
| 1            | PTF ID                         |
| 2            | Release level                  |
| 3            | Product option                 |
| 4            | Load ID                        |
| 5            | Loaded status                  |
| 6            | Cover letter status            |
| 7            | On-order status                |
| 8            | Save file status               |
| 9            | File name                      |
| 10           | File library name              |
| 11           | PTF type                       |
| 12           | IPL action                     |
| 13           | Action pending                 |
| 14           | Action required                |
| 15           | PTF is released                |
| 16           | Target release                 |
| 17           | Superseding PTF                |
| 18           | Current IPL source             |
| 19           | Minimum level                  |
| 20           | Maximum level                  |
| 21           | Format information available   |
| 22           | Status date and time           |
| 23           | Licensed Internal Code group   |
| 24           | Superseded by PTF ID           |
| 25           | Current server IPL source      |
| 26           | Server IPL required            |
| 27           | Creation date and time         |
| 28           | Technology refresh PTF         |
| 29           | Reserved                       |


### getProductInfo
**Description:**

Get the status of specified product.

**Syntax:**

getProductInfo (string prod[, int option[, function callback(output)]])

Parameters 
- prod `<string>` The product name.

- option `<object>` The option of the product. If it is not set, then the *BASE option("0000") is selected. The valid value is 0 ~ 99.

- callback `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QSZRTVPR

**Example:**

```js
var xt = require("itoolkit");

var pd = require('itoolkit/iProd');

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var prod = new pd.iProd(conn);

console.log(JSON.stringify(prod.getProductInfo("5770DG1")));

console.log(JSON.stringify(prod.getProductInfo("5770SS1", 1)));
```

| Index         | Field                                         |
| -----        | -----                                          |
| 0            | Reserved                                       |
| 1            | Product ID                                     |
| 2            | Release level                                  |
| 3            | Product option                                 |
| 4            | Load ID                                        |
| 5            | Loaded type                                    |
| 6            | Symbolic load state                            |
| 7            | Load error indicator                           |
| 8            | Load state                                     |
| 9            | Supported flag                                 |
| 10           | Registration type                              |
| 11           | Registration value                             |
| 12           | Reserved                                       |
| 13           | Offset to additional information               |
| 14           | Primary language load identifier               |
| 15           | Minimum target release                         |
| 16           | Minimum VRM of *BASE required by option        |
| 17           | Requirements met between base and option value |
| 18           | Level                                          |
| 19           | Reserved                                       |

### getInstalledProducts

**Description:**

Get the list of all installed products.

**Syntax:**

getInstalledProducts ( [function callback(output)])

**Parameters:**

- callback `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QSZSLTPR

**Example:**

```js
var xt = require("itoolkit");

var pd = require('itoolkit/iProd');

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var prod = new pd.iProd(conn);

console.log(JSON.stringify(prod.getInstalledProducts()));
```

| Index         | Field                        |
| -----        | -----                         |
| 0            | Product ID                    |
| 1            | Product option                |
| 2            | Release level                 |
| 3            | Description text message ID   |
| 4            | Description text object name  |
| 5            | Description text library name |
| 6            | Installed flag                |
| 7            | Supported flag                |
| 8            | Registration type             |
| 9            | Registration value            |
| 10           | Description text              |

**NOTE** Repeats if more records available



## Class iUserSpace

### iUserSpace

**Description:**

Construct a new iUserSpace object.

**Syntax:**

iUserSpace (iConn conn)

**Parameters:**

- conn `<object>` An iConn object representing the target IBM i system.

**Example:**

```js
var xt = require("itoolkit");

var usp = require('itoolkit/iUserSpace);

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var userspace = new usp.iUserSpace(conn);
```


### createUserSpace
**Description:**

Create a new user space.

**Syntax:**

createUserSpace(string name, string lib, string attr, int size, string auth, string desc)

**Parameters:**

- name `<string>` The user space name. (10 characters max).

- lib `<string>` Name of the library where the user space is located (10 characters max). If it is blank then "*CURLIB" is used.

- attr `<string>` The extended attribute of the user space (11 characters max). If it is blank then "LOG" is used.

- size `<number>` The initial size of the user space being created. This value must be from 1 byte to 16, 776, 704 bytes. If it is blank then "50" is used.

- auth `<string>` The authority you give users who do not have specific private or group authority to the user space. Once the user space has been created, its public authority stays the same when it is moved to another library or restored from backup media. If it is blank then "*USE" is used.

   The valid values for this parameter are:

   - *ALL -- The user can perform all authorized operations on the object.
   Authorization list name -- The user space is secured by the specified authorization list, and its public authority is set to *AUTL. The specified authorization list must exist on the system when this API is called. If it does not exist, the create process fails, and an error is returned to the application.
   - *CHANGE -- The user can read the object description and has read, add, update, and delete authority to the object.
   - *EXCLUDE -- The user cannot access the object in any way.
   - *LIBCRTAUT -- The public authority for the user space is taken from the CRTAUT value for the target library when the object is created. If the CRTAUT value for the library changes later, that change does not affect user spaces already created. If the CRTAUT value contains an authorization list name and that authorization list secures an object, do not delete the list. If you do, the next time you call this API with the *LIBCRTAUT parameter, it will fail.
   - *USE -- The user can read the object and its description but cannot change them.

- des `<string>` This text briefly describes the user space. (50 characters max).

**IBM i API:**

QUSCRTUS

**Example:**

```js
var xt = require("itoolkit");

var pd = require('itoolkit/iProd');

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var prod = new pd.iProd(conn);

userspace.createUserSpace("TEST", "LIB", "", "", "", "");

userspace.setUserSpaceData("TEST", "LIB", 20, "Hello!");

console.log(JSON.stringify(userspace.getUserSpaceData("TEST", "LIB", 20)));

userspace.deleteUserSpace("TEST", "LIB");
```


### setUserSpaceData
**Description:**

Set the content of the user space.

**Syntax:**

setUserSpaceData (string name, string lib, int size, string data[, function cb(output)])

**Parameters:** 
- name `<string>` The user space name. (10 characters max).

- lib `<string>` Name of the library where the user space is located (10 characters max). If it is blank then "*CURLIB" is used.

- size `<number>` The length of the new data in the input data parameter. The length must be greater than 0.

- data `<string>` The new data to be placed into the user space. The field must be at least as long as the length of data parameter.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QUSCHGUS

**Returns:** 

`<boolean>` true if the request is successfully processed.



### getUserSpaceData
**Description:**

Get the content of the user space.

**Syntax:**

getUserSpaceData (string name, string lib, int size[, function cb(output)])

**Parameters:**

- name `<string>` The user space name. (10 characters max).

- lib `<string>` Name of the library where the user space is located (10 characters max). If it is blank then "*CURLIB" is used.

- size:`<number>` The length of the data to retrieve. The length must be greater than 0.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QUSRTVUS

**Returns:**

It returns the content of the user space.



### deleteUserSpace
**Description:**

Delete the user space.

**Syntax:**

deleteUserSpace (string name, string lib)

**Parameters:**
- name `<string>` The user space name. (10 characters max).

- lib `<string>` Name of the library where the user space is located (10 characters max). If it is blank then "*CURLIB" is used.

**IBM i API:**

QUSDLTUS

**Returns:**

It returns true if the request is successfully processed.



## Class iNetwork

### iNetwork

**Description:**

Construct a new iNetwork object.

**Syntax:**

iNetwork(iConn conn)

**Parameters:** 

- conn `<object>` An iConn object representing the target IBM i system.

**Example:**

```js
var xt = require("itoolkit");

var nt = require('itoolkit/iNetwork');

var net = new nt.iNetwork(conn);

net.getNetInterfaceData("localhost", function(output) {
console.log(JSON.stringify(output));});

```

### getTCPIPAttr

**Description:**

Retrieve TCP/IP Attributes.

**Syntax:**

getPTFInfo([function callback(output)])

**Parameters:** 

- callback `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QTOCNETSTS/QtocRtvTCPA

**Example:**

```js
var xt = require("itoolkit");

var nt = require('itoolkit/iNetwork');

var net = new nt.iNetwork(conn);

net.getTCPIPAttr(function(output) {console.log(JSON.stringify(output));});
```
**Output Fields:**

| Index         | Field                                      |
| -----        | -----                                       |
| 0            | TCP/IPv4 stack status                       |
| 1            | How long active                             |
| 2            | When last started - date                    |
| 3            | When last started - time                    |
| 4            | When last ended - date                      |
| 5            | When last ended - time                      |
| 6            | Who last started - job name                 |
| 7            | Who last started - job user name            |
| 8            | Who last started - job number               |
| 9            | Who last started - internal job identifier  |
| 10           | Who last ended - job name                   |
| 11           | Who last ended - job user name              |
| 12           | Who last ended - job number                 |
| 13           | Who last ended - internal job identifier    |
| 14           | Offset to additional information            |
| 15           | Length of additional information            |
| 16           | Limited mode                                |
| 17           | Offset to list of Internet addresses        |
| 18           | Number of Internet addresses                |
| 19           | Entry length for list of Internet addresses |
| 20           | DNS protocol                                |
| 21           | Retries                                     |
| 22           | Time interval                               |
| 23           | Search order                                |
| 24           | Initial domain name server                  |
| 25           | DNS listening port                          |
| 26           | Host name                                   |
| 27           | Domain name                                 |
| 28           | Reserved                                    |
| 29           | Domain search list                          |


### getNetInterfaceData
**Description:**

Retrieves detailed information about a specified IPv4 network interface.

**Syntax:**

getNetInterfaceData (string IP[, function callback(output)])

**Parameters:**
- IP `<string>` The IP address of the interface to be checked.

- callback `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QTOCNETSTS/QtocRtvNetIfcDta

**Example:**

```js
var xt = require("itoolkit");

var nt = require('itoolkit/inetwork');

var net = new nt.iNetwork(conn);

net.getNetInterfaceData("127.0.0.1", function(output) {
console.log(JSON.stringify(output));});
```
**Output Fields:**

| Index         | Field                                        |
| -----        | -----                                         |
| 0            | Internet address                              |
| 1            | Internet address binary                       |
| 2            | Network address                               |
| 3            | Network address binary                        |
| 4            | Line description                              |
| 5            | Interface status                              |
| 6            | Interface type of service                     |
| 7            | Interface MTU                                 |
| 8            | Interface line type                           |
| 9            | Host address                                  |
| 10           | Host address binary                           |
| 11           | Interface subnet mask                         |
| 12           | Interface subnet mask binary                  |
| 13           | Directed broadcast address                    |
| 14           | Directed broadcast address binary             |
| 15           | Change date                                   |
| 16           | Change time                                   |
| 17           | Associated local interface                    |
| 18           | Associated local interface binary             |
| 19           | Change status                                 |
| 20           | Packet rules                                  |
| 21           | Automatic start                               |
| 22           | TRLAN bit sequencing                          |
| 23           | Interface type                                |
| 24           | Proxy ARP allowed                             |
| 25           | Proxy ARP enabled                             |
| 26           | Configured MTU                                |
| 27           | Network name                                  |
| 28           | Interface name                                |
| 29           | Alias name                                    |
| 30           | Interface description                         |
| 31           | Offset to preferred interface list            |
| 32           | Number of entries in preferred interface list |
| 33           | Length of one preferred interface list entry  |
| 34           | DHCP created                                  |
| 35           | DHCP dynamic DNS updates                      |
| 36           | DHCP lease expiration                         |
| 37           | DHCP lease expiration - date                  |
| 38           | DHCP lease expiration - time                  |
| 39           | DHCP lease obtained                           |
| 40           | DHCP lease obtained - date                    |
| 41           | DHCP lease obtained - time                    |
| 42           | Use DHCP unique identifier                    |
| 43           | DHCP server IP address                        |
| 44           | Preferred interface Internet address          |
| 45           | Preferred interface Internet address binary   |



## Class iObj

### iObj

**Description:**

Construct a new iObj object.

**Syntax:**

iObj(iConn conn)

**Parameters:**

- conn `<object>` An iConn object representing the target IBM i system.

**Example:**

```js
var xt = require("itoolkit");

var ob = require('itoolkit/iObj');

var obj = new ob.iObj(conn);

obj.retrCmdInfo("CRTLIB", function(output) {
console.log(JSON.stringify(output));});
```


### retrUsrAuth

**Description:**

Retrieves a specific user's authority for an object to the caller

**Syntax:**

retrUsrAuth (string user, string type, string obj, string lib[, function cb(output)])

**Parameters:**
- user `<string>` The name of the user whose object authority is returned

  Special values:

  - *CURRENT --The authority of the user currently running to the specified object is returned.

  - *PUBLIC --The public authority for the object is returned.

- type `<string>` The type of object for which authority information is returned. For example, if the target object is a program, then *PGM should be set to the type parameter. Following object types are supported.

*ALRTBL, *AUTL, *BLKSF, *BNDDIR, *CFGL, *CHTFMT, *CHRSF, *CLD, *CLS, *CMD, *CNNL, *COSD, *CRG, *CRQD, *CSI, *CSPMAP, *CSPTBL, *CTLD, *DDIR, *DEVD, *DIR, *DOC, *DSTMF, *DTAARA, *DTADCT, *DTAQ, *EDTD, *EXITRG, *FCT, *FIFO, *FILE, *FLR, *FNTRSC, *FNTTBL, *FORMDF, *FTR, *GSS, *IGCDCT, *IGCSRT, *IGCTBL, *IMGCLG, *IPXD, *JOBD, *JOBQ, *JOBSCD, *JRN, *JRNRCV, *LIB, *LIND, *LOCALE, *MBR, *MEDDFN, *MENU, *MGTCOL, *MODD, *MODULE, *MSGF, *MSGQ, *M36, *M36CFG, *NODGRP, *NODL, *NTBD, *NWID, *NWSD, *OUTQ, *OVL, *PAGDFN, *PAGSEG, *PDG, *PGM, *PNLGRP, *PRDAVL, *PRDDFN, *PRDLOD, *PSFCFG, *QMFORM, *QMQRY, *QRYDFN, *RCT, *SBSD, *SCHIDX, *SOCKET, *SPADCT, *SQLPKG, *SQLUDT, *SQLXSR, *SQL2XSR, *SRVPGM, *SSND, *STMF, *SVRSTG, *SYMLNK, *S36, *TBL, *TIMZON, *USRIDX, *USRPRF, *USRQ, *USRSPC, *VLDL, *WSCST

- obj `<string>` The object name.

- lib `<string>` The library name.

  Special values:

  - *CURLIB --The current library is used to locate the object. If there is no current library, QGPL (general purpose library) is used.

  - *LIBL --The library list is used to locate the object.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QSYRUSRA

**Example:**

```js
var xt = require("itoolkit");

var ob = require('itoolkit/iObj');

var obj = new ob.iObj(conn);

console.log(JSON.stringify(

obj.retrUsrAuth("*PUBLIC","*PGM","XMLCGI","QXMLSERV")));
```
**Output Fields:**

| Index        | Field                                 |
| -----        | -----                                 |
| 0            | Object authority / Data authority     |
| 1            | Authorization list management         |
| 2            | Object operational                    |
| 3            | Object management                     |
| 4            | Object existence                      |
| 5            | Data read                             |
| 6            | Data add                              |
| 7            | Data update                           |
| 8            | Data delete                           |
| 9            | Authorization list                    |
| 10           | Authority source                      |
| 11           | Some adopted authority                |
| 12           | Adopted object authority              |
| 13           | Adopted authorization list management |
| 14           | Adopted object operational            |
| 15           | Adopted object management             |
| 16           | Adopted object existence              |
| 17           | Adopted data read                     |
| 18           | Adopted data add                      |
| 19           | Adopted data update                   |
| 20           | Adopted data delete                   |
| 21           | Adopted data execute                  |
| 22           | Reserved                              |
| 23           | Adopted object alter                  |
| 24           | Adopted object reference              |
| 25           | Reserved                              |
| 26           | Data execute                          |
| 27           | Reserved                              |
| 28           | Object alter                          |
| 29           | Object reference                      |
| 30           | ASP device name of library            |
| 31           | ASP device name of object             |
| 32           | Reserved                              |
| 33           | Offset to group information table     |
| 34           |Number of group table entries returned |



### retrCmdInfo

**Description:**

Retrieves information from a command definition object.

**Syntax:**

retrCmdInfo(string cmd[, string lib[, function cb(output)]])

**Parameters:**
- cmd `<string>` The command name.

- lib `<string>` The library name. If it is undefined, *LIBL will be used.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QCDRCMDI

**Example:**

```js
var xt = require("itoolkit");

var ob = require('itoolkit/iObj');

var obj = new ob.iObj(conn);

console.log(JSON.stringify(obj.retrCmdInfo("CRTLIB")));
```
**Output Fields:**

| Index        | Field                                                                |
| -----        | -----                                                                |
| 0            | Command name                                                         |
| 1            | Command library name                                                 |
| 2            | Command processing program or proxy target command                   |
| 3            | Command processing program's or proxy target command's library name  |
| 4            | Source file name                                                     |
| 5            | Source file library name                                             |
| 6            | Source file member name                                              |
| 7            | Validity check program name                                          |
| 8            | Validity check program library name                                  |
| 9            | Mode information                                                     |
| 10           | Where allowed to run                                                 |
| 11           | Allow limited user                                                   |
| 12           | Maximum positional parameters                                        |
| 13           | Prompt message file name                                             |
| 14           | Prompt message file library name                                     |
| 15           | Message file name                                                    |
| 16           | Message file library name                                            |
| 17           | Help panel group name                                                |
| 18           | Help panel group library name                                        |
| 19           | Help identifier                                                      |
| 20           | Search index name                                                    |
| 21           | Search index library name                                            |
| 22           | Current library                                                      |
| 23           | Product library                                                      |
| 24           | Prompt override program name                                         |
| 25           | Prompt override program library name                                 |
| 26           | Restricted to target release                                         |
| 27           | Text description                                                     |
| 28           | Command processing program call state                                |
| 29           | Validity check program call state                                    |
| 30           | Prompt override program call state                                   |
| 31           | Offset to help bookshelf information                                 |
| 32           | Length of help bookshelf information                                 |
| 33           | Coded character set ID (CCSID)                                       |
| 34           | Enabled for GUI indicator                                            |
| 35           | Threadsafe indicator                                                 |
| 36           | Multithreaded job action                                             |
| 37           | Proxy command indicator                                              |
| 38           | Prompt message file text indicator                                   |



### retrPgmInfo

**Description:**

Retrieves information from a program object.

**Syntax:**

retrPgmInfo(string pgm, string, lib[, function cb(output)])

**Parameters:**
- pgm `<string>` The program name.

- lib `<string>` The library name. If it is undefined, *LIBL will be used.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QCLRPGMI

**Example:**

```js
var xt = require("itoolkit");

var ob = require('itoolkit/iObj');

var obj = new ob.iObj(conn);

console.log(JSON.stringify(obj.retrPgmInfo("XMLCGI","QXMLSERV")));
```

**Output Fields:**

| Index        | Field                                        |
| -----        | -----                                        |
| 0            | Program name                                 |
| 1            | Program library name                         |
| 2            | Program owner                                |
| 3            | Program attribute                            |
| 4            | Creation date and time                       |
| 5            | Source file name                             |
| 6            | Source file library name                     |
| 7            | Source file member name                      |
| 8            | Source file updated date and time            |
| 9            | Observable information                       |
| 10           | User profile option                          |
| 11           | Use adopted authority                        |
| 12           | Log commands                                 |
| 13           | Allow RTVCLSRC                               |
| 14           | Fix decimal data                             |
| 15           | Text description                             |
| 16           | Type of program                              |
| 17           | Teraspace storage-enabled program            |
| 18           | Reserved                                     |
| 19           | Minimum number of parameters                 |
| 20           | Maximum number of parameters                 |
| 21           | Program size                                 |
| 22           | Associated space size                        |
| 23           | Static storage size                          |
| 24           | Automatic storage size                       |
| 25           | Number of MI instructions                    |
| 26           | Number of MI ODT entries                     |
| 27           | Program state                                |
| 28           | Compiler identification                      |
| 29           | Earliest release program can run             |
| 30           | Sort sequence table name                     |
| 31           | Sort sequence table library name             |
| 32           | Language identifier                          |
| 33           | Program domain                               |
| 34           | Conversion required                          |
| 35           | Conversion details                           |
| 36           | Reserved                                     |
| 37           | Optimization                                 |
| 38           | Paging pool                                  |
| 39           | Update program automatic storage area (PASA) |
| 40           | Clear program automatic storage area (PASA)  |
| 41           | Paging amount                                |
| 42           | Reserved                                     |
| 43           | Program entry procedure module               |
| 44           | Program entry procedure module library       |
| 45           | Activation group attribute                   |
| 46           | Observable information compressed            |
| 47           | Run-time information compressed              |
| 48           | Release program created on                   |
| 49           | Shared activation group                      |
| 50           | Allow update                                 |
| 51           | Program CCSID                                |
| 52           | Number of modules                            |
| 53           | Number of service programs                   |
| 54           | Number of copyrights                         |
| 55           | Number of unresolved references              |
| 56           | Release program created for                  |
| 57           | Allow static storage reinitialization        |
| 58           | All creation data                            |
| 59           | Allow bound *SRVPGM library name update      |
| 60           | Profiling data                               |
| 61           | Teraspace storage enabled modules            |
| 62           | Storage model                                |
| 63           | Uses argument optimization (ARGOPT)          |




### retrSrvPgmInfo

**Description:**

Retrieves information from a service program object.

**Syntax:**

retrSrvPgmInfo(string srvpgm, string lib[, function cb(output)])

**Parameters:** 
- srvpgm `<string>` The service program name.

- lib `<string>` The library name. If it is undefined, *LIBL will be used.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QBNRSPGM

**Example:**

```js
var xt = require("itoolkit");

var ob = require('itoolkit/iObj');

var obj = new ob.iObj(conn);

console.log(JSON.stringify(obj.retrSrvPgmInfo("QZSRVSSL","QHTTPSVR")));
```

**Output Fields:**

| Index        | Field                                    |
| -----        | -----                                    |
| 0            | Service program name                     |
| 1            | Service program library name             |
| 2            | Service program owner                    |
| 3            | Service program attribute                |
| 4            | Creation date and time                   |
| 5            | Export source file name                  |
| 6            | Export source file library name          |
| 7            | Export source file member name           |
| 8            | Activation group attribute               |
| 9            | Current export signature                 |
| 10           | User profile                             |
| 11           | Observable information compressed        |
| 12           | Run-time information compressed          |
| 13           | Service program CCSID                    |
| 14           | Number of modules                        |
| 15           | Number of service programs               |
| 16           | Number of copyrights                     |
| 17           | Text description                         |
| 18           | Shared activation group                  |
| 19           | Allow update                             | 
| 20           | Number of unresolved references          |
| 21           | Use adopted authority                    |
| 22           | Allow bound *SRVPGM library name update  |
| 23           | Profiling data                           |
| 24           | Teraspace storage enabled modules        |
| 25           | Storage model                            |
| 26           | Uses argument optimization (ARGOPT)      |
| 27           | Reserved '00'X                           |
| 28           | Service program state                    |
| 29           | Service program domain                   |
| 30           | Associated space size                    |
| 31           | Static storage size                      |
| 32           | Service program size                     |
| 33           | Release service program created on       |
| 34           | Earliest release service program can run |
| 35           | Release service program created for      |
| 36           | Allow static storage reinitialization    |
| 37           | Conversion required                      |
| 38           | All creation data                        |
| 39           | Conversion details                       |
| 40           | Reserved                                 |
| 41           | Paging pool                              |
| 42           | Paging amount                            |





### retrUserInfo
**Description:**

Retrieves information about a user profile.

**Syntax:**

retrUserInfo(string user[, function cb(output)])

**Parameters:**
- user `<string>` The user profile.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QSYRUSRI

**Example:**

```js
var xt = require("itoolkit");

var ob = require('itoolkit/iObj');

var obj = new ob.iObj(conn);

console.log(JSON.stringify(obj.retrUserInfo("QSYS")));
```

**Output Fields:**

| Index        | Field                          |
| -----        | -----                          |
| 0            | User profile name              |
| 1            | Previous sign-on date and time |
| 2            | Reserved                       |
| 3            | Sign-on attempts not valid     |
| 4            | Status                         |
| 5            | Password change date           |
| 6            | No password indicator          |
| 7            | Reserved                       |
| 8            | Password expiration interval   |
| 9            | Date password expires          |
| 10           | Days until password expires    |
| 11           | Set password to expire         |
| 12           | Display sign-on information    |
| 13           | Local password management      |
| 14           | Block password change          |



### retrUserAuthToObj

**Description:**

Retrieves information about the users who are authorized to an object.

**Syntax:**

retrUserAuthToObj(string path[, function cb(output)])

**Parameters:** 

- path `<string>` The abosulute path of the object.

- cb `<string>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QSYRTVUA

**Example:**

```js
var xt = require("itoolkit");

var ob = require('itoolkit/iObj');

var obj = new ob.iObj(conn);

console.log(JSON.stringify(obj.retrUserAuthToObj("/home ")));
```

**Output Fields:**

| Index        | Field                         |
| -----        | -----                         |
| 0            | Profile name                  |
| 1            | User or group indicator       |
| 2            | Data authority                |
| 3            | Authorization list management |
| 4            | Object management             |
| 5            | Object existence              |
| 6            | Object alter                  |
| 7            | Object reference              |
| 8            | Reserved                      |
| 9            | Object operational            |
| 10           | Data read                     |
| 11           | Data add                      |
| 12           | Data update                   |
| 13           | Data delete                   |
| 14           | Data execute                  |




### addToLibraryList

**Description:**

Retrieves information about the users who are authorized to an object.

**Syntax:**

addToLibraryList(string lib)

**Parameters:**
- lib `striing` The library name to be added to the library list.

**IBM i API:**

QLICHGLL

**Example:**

```js
var xt = require("itoolkit");

var ob = require('itoolkit/iObj');

var obj = new ob.iObj(conn);

console.log(JSON.stringify(obj.addToLibraryList("QHTTPSVR")));
```

**Returns:**

`<boolean>` It returns true if the request is successfully processed.



### Class iDataQueue

## iDataQueue

**Description:**

Construct a new iDataQueue object.

**Syntax:**

iDataQueue(iConn conn)

**Parameters:** 

- conn `<object>` An iConn object representing the target IBM i system.

**Example:**

```js
var xt = require("itoolkit");

var dq = require('itoolkit/iDataQueue);

var conn = new xt.iConn("*LOCAL", "USER", "PASSWORD");

var dtq = new dq.iDataQueue(conn);

dtq.sendToDataQueue("TESTQ", "TEST", "Hello World!"); 

console.log(dtq.receiveFromDataQueue("TESTQ", "TEST", 12)); 

dtq.clearDataQueue("TESTQ", "TEST");
```


### sendToDataQueue

**Description:**

Sends data to the specified data queue.

**Syntax:**

sendToDataQueue(string name, string lib, string data[, function cb(output)])

**Parameters:** 

- name `<string>` The data queue name. (10 characters max).

- lib `<string>` Name of the library where the data queue is located (10 characters max). If it is blank then "*CURLIB" is used.

- data `<string>` The new data to be sent to the data queue.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QSNDDTAQ

**Returns:**

`<boolean>` It returns true if the request is successfully processed.


### receiveFromDataQueue

**Description:**

Receives data from the specified data queue.

**Syntax:**

receiveFromDataQueue(string name, string lib, int size[, function cb(output)])

**Parameters:** 

- name `<string>` The data queue name. (10 characters max).

- lib `<string>` Name of the library where the data queue is located (10 characters max). If it is blank then "*CURLIB" is used.

- size `<number>` The length of the data to retrieve. The length must be greater than 0.

- cb `<function>` The callback function to handle the output for asynchronous mode.

**IBM i API:**

QRCVDTAQ

**Returns:**

`<string>` It returns the content of the data queue.



### clearDataQueue

**Description:**

Clear the data queue.

**Syntax:**

clearDataQueue(string name, string lib)

**Parameters:** 

- name `<string>` The data queue name. (10 characters max).

- lib `<string>` Name of the library where the data queue is located (10 characters max). If it is blank then "*CURLIB" is used.

**IBM i API:**

QCLRDTAQ

**Returns:**

`<boolean>` It returns true if the request is successfully processed.
